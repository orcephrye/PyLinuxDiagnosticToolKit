
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.4">
    
    
      
        <title>Sshthreader - PyLinuxDiagnosticToolKit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.f7f47774.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#4cae4f">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="green" data-md-color-accent="lightgreen">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#module-sshthreader" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="PyLinuxDiagnosticToolKit" class="md-header__button md-logo" aria-label="PyLinuxDiagnosticToolKit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyLinuxDiagnosticToolKit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Sshthreader
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/orcephrye/PyLinuxDiagnosticToolKit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    PyLinuxDiagnosticToolKit
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PyLinuxDiagnosticToolKit" class="md-nav__button md-logo" aria-label="PyLinuxDiagnosticToolKit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    PyLinuxDiagnosticToolKit
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/orcephrye/PyLinuxDiagnosticToolKit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    PyLinuxDiagnosticToolKit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Summary
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../TUTORIAL/" class="md-nav__link">
        Tutorial
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../PyLinuxDiagnosticToolKit/sshConnector/" class="md-nav__link">
        sshConnector
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../PyLinuxDiagnosticToolKit/LinuxModules/" class="md-nav__link">
        CommandContainer
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      <label class="md-nav__link" for="__nav_5">
        Reference
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../CommandContainers/" class="md-nav__link">
        Commandcontainers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../SCPChannel/" class="md-nav__link">
        Scpchannel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../SFTPChannel/" class="md-nav__link">
        Sftpchannel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../genericCmdModule/" class="md-nav__link">
        Genericcmdmodule
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ldtk/" class="md-nav__link">
        Ldtk
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../sshBufferControl/" class="md-nav__link">
        Sshbuffercontrol
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../sshChannelEnvironment/" class="md-nav__link">
        Sshchannelenvironment
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../sshConnect/" class="md-nav__link">
        Sshconnect
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../sshEnvironmentControl/" class="md-nav__link">
        Sshenvironmentcontrol
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../sshEnvironmentManager/" class="md-nav__link">
        Sshenvironmentmanager
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Sshthreader
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Sshthreader
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    Variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sshthreader" class="md-nav__link">
    sshThreader
  </a>
  
    <nav class="md-nav" aria-label="sshThreader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processrootlogin" class="md-nav__link">
    processRootLogin
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#addenvironment" class="md-nav__link">
    addEnvironment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#becomeroot" class="md-nav__link">
    becomeRoot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#becomeuser" class="md-nav__link">
    becomeUser
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkconnection" class="md-nav__link">
    checkConnection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkwhoami" class="md-nav__link">
    checkWhoAmI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consoleescalation" class="md-nav__link">
    consoleEscalation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#createconn" class="md-nav__link">
    createConn
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#createenvironment" class="md-nav__link">
    createEnvironment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disconnect" class="md-nav__link">
    disconnect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disconnectenvironments" class="md-nav__link">
    disconnectEnvironments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environmentchange" class="md-nav__link">
    environmentChange
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#escalate" class="md-nav__link">
    escalate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executeonenvironment" class="md-nav__link">
    executeOnEnvironment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executeonthread" class="md-nav__link">
    executeOnThread
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getenvironment" class="md-nav__link">
    getEnvironment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getmaxsessionsvalue" class="md-nav__link">
    getMaxSessionsValue
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getprompt" class="md-nav__link">
    getPrompt
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isidle" class="md-nav__link">
    isIdle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logoutconsole" class="md-nav__link">
    logoutConsole
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logoutcurrentuser" class="md-nav__link">
    logoutCurrentUser
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removeenvironment" class="md-nav__link">
    removeEnvironment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resetenvironment" class="md-nav__link">
    resetEnvironment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#threadeddisconnect" class="md-nav__link">
    threadedDisconnect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#waitforidle" class="md-nav__link">
    waitForIdle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whoami" class="md-nav__link">
    whoami
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    Variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sshthreader" class="md-nav__link">
    sshThreader
  </a>
  
    <nav class="md-nav" aria-label="sshThreader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processrootlogin" class="md-nav__link">
    processRootLogin
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#addenvironment" class="md-nav__link">
    addEnvironment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#becomeroot" class="md-nav__link">
    becomeRoot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#becomeuser" class="md-nav__link">
    becomeUser
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkconnection" class="md-nav__link">
    checkConnection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkwhoami" class="md-nav__link">
    checkWhoAmI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consoleescalation" class="md-nav__link">
    consoleEscalation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#createconn" class="md-nav__link">
    createConn
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#createenvironment" class="md-nav__link">
    createEnvironment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disconnect" class="md-nav__link">
    disconnect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disconnectenvironments" class="md-nav__link">
    disconnectEnvironments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environmentchange" class="md-nav__link">
    environmentChange
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#escalate" class="md-nav__link">
    escalate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executeonenvironment" class="md-nav__link">
    executeOnEnvironment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executeonthread" class="md-nav__link">
    executeOnThread
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getenvironment" class="md-nav__link">
    getEnvironment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getmaxsessionsvalue" class="md-nav__link">
    getMaxSessionsValue
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getprompt" class="md-nav__link">
    getPrompt
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isidle" class="md-nav__link">
    isIdle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logoutconsole" class="md-nav__link">
    logoutConsole
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logoutcurrentuser" class="md-nav__link">
    logoutCurrentUser
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removeenvironment" class="md-nav__link">
    removeEnvironment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resetenvironment" class="md-nav__link">
    resetEnvironment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#threadeddisconnect" class="md-nav__link">
    threadedDisconnect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#waitforidle" class="md-nav__link">
    waitForIdle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whoami" class="md-nav__link">
    whoami
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/orcephrye/PyLinuxDiagnosticToolKit/edit/main/reference/sshThreader.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="module-sshthreader">Module sshThreader</h1>
<p>None</p>
<p>None</p>
<details class="example"><summary>View Source</summary><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="ch">#!/usr/bin/env python</span>

<span class="c1"># -*- coding=utf-8 -*-</span>

<span class="c1">#</span>

<span class="c1"># Author: Timothy Nodine, Ryan Henrichson</span>

<span class="c1"># Version: 0.5.0</span>

<span class="c1"># Date: 02/19/15</span>

<span class="c1"># Description: This is the 6th class in the sshConnect chain. Technically the last in this change. The next class to</span>

<span class="c1"># inherent this class should be CommandRunner which no longer focuses on anything regarding SSH. This file has two</span>

<span class="c1"># classes. The public class &#39;sshThreader&#39; and a private class &#39;_createThread&#39;. The sshThreader should be the only</span>

<span class="c1"># class called.</span>

<span class="c1"># A requirement for portray</span>

<span class="c1"># import sys</span>

<span class="c1"># sys.path.append(&#39;/home/rye/PycharmProjects/PyCustomCollections&#39;)</span>

<span class="c1"># sys.path.append(&#39;/home/rye/PycharmProjects/PyCustomParsers&#39;)</span>

<span class="c1"># sys.path.append(&#39;/home/rye/PycharmProjects/PyMultiTasking&#39;)</span>

<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">import</span> <span class="nn">traceback</span>

<span class="kn">from</span> <span class="nn">PyLinuxDiagnosticToolKit.libs.LDTKExceptions</span> <span class="kn">import</span> <span class="n">SSHExceptionChannel</span>

<span class="c1"># A requirement for portray</span>

<span class="k">try</span><span class="p">:</span>

    <span class="kn">from</span> <span class="nn">LinuxModules.CommandContainers</span> <span class="kn">import</span> <span class="n">CommandContainer</span>

<span class="k">except</span><span class="p">:</span>

    <span class="kn">from</span> <span class="nn">ldtk</span> <span class="kn">import</span> <span class="n">CommandContainer</span>

<span class="kn">from</span> <span class="nn">sshConnector.sshEnvironmentManager</span> <span class="kn">import</span> <span class="n">sshEnvironmentManager</span>

<span class="kn">from</span> <span class="nn">sshConnector.sshLibs.sshChannelEnvironment</span> <span class="kn">import</span> <span class="n">EnvironmentControls</span>

<span class="kn">from</span> <span class="nn">PyMultiTasking.ThreadingUtils</span> <span class="kn">import</span> <span class="n">ThreadPool</span> <span class="k">as</span> <span class="n">Pool</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Any</span>

<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>

<span class="c1"># logging.basicConfig(format=&#39;%(asctime)s %(levelname)s %(name)s %(funcName)s %(lineno)s %(message)s&#39;,</span>

<span class="c1">#                     level=logging.INFO)</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;SSHThreader&#39;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">sshThreader</span><span class="p">(</span><span class="n">sshEnvironmentManager</span><span class="p">):</span>

    <span class="n">threadDict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">tPool</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">tki</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arguments</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot; This class is designed to managed another private class that inherits from Thread. The __init__ only job</span>

<span class="sd">            is to build and pass info along to the rest of the chain while overriding the root flag in args to avoid</span>

<span class="sd">            unnecessary work.</span>

<span class="sd">        - :param arguments: Passed along super to sshEnvironmentManager&#39;s construct.</span>

<span class="sd">        - :param kwargs: A placeholder for inheritance.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">sshThreader</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">arguments</span><span class="o">=</span><span class="n">arguments</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tki</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;tki&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tPool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="n">maxWorkers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_MAX_SESSIONS</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">workerAutoKill</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">isIdle</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; This checks the &#39;ThreadPool&#39; class&#39;s &#39;isIdle()&#39; function and returns the results.</span>

<span class="sd">        - :return: bool</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tPool</span><span class="o">.</span><span class="n">is_idle</span>

    <span class="k">def</span> <span class="nf">waitForIdle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; This is a wrapper for the &#39;waitCompletion&#39; method in ThreadingPool.</span>

<span class="sd">        - :param kwargs: Review the &#39;waitCompletion&#39; method in ThreadingPool for all the arguments.</span>

<span class="sd">        - :return: (bool)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tPool</span><span class="o">.</span><span class="n">wait_completion</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">executeOnThread</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">CommandContainer</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>

                        <span class="n">EnvObj</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">EnvironmentControls</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandContainer</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; Submits a new command to be executed via the &#39;submit&#39; method in Pool. All commands ran should be within a</span>

<span class="sd">            CommandContainer. So the method first checks to see if the command is already a Container or not.</span>

<span class="sd">        - :param CC: [Either a CommandContainer or Any other datatype]</span>

<span class="sd">        - :param EnvObj: (EnvironmentControls) default None. This specifies a Channel to run the command on. This</span>

<span class="sd">              bypasses using a Thread and instead expects that the channelObject is already &#39;active&#39; or &#39;taken&#39; by the</span>

<span class="sd">              thread currently calling this method.</span>

<span class="sd">        - :param kwargs: used to create a new CommandContainer is &#39;cmd&#39; is not a CommandContainer</span>

<span class="sd">        - :return: CommandContainer (The same container that either was submitted as the cmd or the one created)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_preparserCmd</span><span class="p">(</span><span class="n">commands</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">commands</span><span class="p">,</span> <span class="n">CommandContainer</span><span class="p">):</span>

                <span class="k">return</span> <span class="n">commands</span>

            <span class="k">if</span> <span class="s1">&#39;commandKey&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>

                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;commandKey&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="s1">&#39;tki&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">tki</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tki&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tki</span>

            <span class="k">return</span> <span class="n">CommandContainer</span><span class="p">(</span><span class="n">commands</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">CC</span> <span class="o">=</span> <span class="n">_preparserCmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">EnvObj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">tPool</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_exeThread</span><span class="p">,</span> <span class="n">CC</span><span class="o">=</span><span class="n">CC</span><span class="p">,</span> <span class="n">submit_task_priority</span><span class="o">=</span><span class="n">CC</span><span class="o">.</span><span class="n">__PRIORITY__</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">CC</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">EnvObj</span><span class="o">.</span><span class="n">active</span><span class="p">:</span>

                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;This channel is not active and it has been manually requested for use by the executor!&quot;</span><span class="p">)</span>

            <span class="k">with</span> <span class="n">CC</span><span class="p">:</span>

                <span class="k">return</span> <span class="n">CC</span><span class="o">.</span><span class="n">executor</span><span class="p">(</span><span class="n">channelObject</span><span class="o">=</span><span class="n">EnvObj</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">threadedDisconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">90</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; This does what it says. It disconnects the SSH connection to a server using a thread for each Environment.</span>

<span class="sd">            This is not necessary faster. In fact it is often slower. This is designed if there are many connections</span>

<span class="sd">            open that have many user and environment escalations. In that situation this becomes faster then</span>

<span class="sd">            &#39;disconnectEnvironments&#39;. However, this is necessary to ensure that the logout commands are not given until</span>

<span class="sd">            all other threaded commands have finished.</span>

<span class="sd">            NOTE: If disconnect is called and then later another connection is established the ThreadPool will not work!</span>

<span class="sd">                The function: &#39;setActiveThreads&#39; will have to be called again in order for Threading to work. The var</span>

<span class="sd">                &#39;_MAX_CHANNELS&#39; must be passed to &#39;setActiveThreads&#39; as the Parm &#39;maxThreads&#39;.</span>

<span class="sd">        - :param wait: (int) default 90 - How long the method is will too wait until all login commands are finished.</span>

<span class="sd">        - :return:</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39; === Disconnecting the SSH connection&#39;</span><span class="p">)</span>

        <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">_parseWait</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>

            <span class="n">w</span> <span class="o">=</span> <span class="n">w</span> <span class="o">-</span> <span class="p">(</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">current_time</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">w</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>

                <span class="n">w</span> <span class="o">=</span> <span class="mi">10</span>

            <span class="k">return</span> <span class="n">w</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tPool</span><span class="p">:</span>

                <span class="nb">super</span><span class="p">(</span><span class="n">sshThreader</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">disconnectEnvironments</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">tPool</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">tPool</span><span class="o">.</span><span class="n">wait_completion</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">wait</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">env</span> <span class="ow">in</span> <span class="p">[</span><span class="n">envs</span> <span class="k">for</span> <span class="n">envs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">EnvironmentList</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">envs</span><span class="o">.</span><span class="n">isMain</span><span class="p">]:</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">tPool</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">disconnectEnvironment</span><span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">tPool</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_parseWait</span><span class="p">(</span><span class="n">wait</span><span class="p">))</span>

                <span class="nb">super</span><span class="p">(</span><span class="n">sshThreader</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainEnvironment</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in threadedDisconnect: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[DEBUG] for threadedDisconnect: </span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">finally</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkConnection</span><span class="p">():</span>

                <span class="nb">super</span><span class="p">(</span><span class="n">sshThreader</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_exeThread</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CC</span><span class="p">:</span> <span class="n">CommandContainer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CommandContainer</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; The method that is passed to the Pool via the &#39;submit&#39; method. This method is the connection between the</span>

<span class="sd">            CommandContainer (which holds the command and manages the output) and the Environment that will be used to</span>

<span class="sd">            execute the command. This is ran on the Pool in a thread. It will also respond with the CC it was given.</span>

<span class="sd">        - :param CC: (CommandContainer)</span>

<span class="sd">        - :param kwargs: (Passed into the &#39;getEnvironment&#39; method)</span>

<span class="sd">        - :return: (CommandContainer) The same as the &#39;CC&#39; parameter</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;running _exeThread for: </span><span class="si">{</span><span class="n">CC</span><span class="o">.</span><span class="n">command</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkConnection</span><span class="p">():</span>

            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;The SSH Connection is closed!&quot;</span><span class="p">)</span>

            <span class="k">raise</span> <span class="n">SSHExceptionChannel</span><span class="p">(</span><span class="s2">&quot;While running a thread it was found that the SSH Channel is closed!&quot;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">setupParams</span><span class="p">(</span><span class="n">otherObject</span><span class="p">:</span> <span class="n">CommandContainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">otherObject</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

                <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

            <span class="k">return</span> <span class="n">otherObject</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> \

                <span class="n">otherObject</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;EnvironmentID&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">otherObject</span><span class="o">.</span><span class="n">timeout</span>

        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;About to with CC&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">CC</span><span class="p">:</span>

            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Successful with of CC&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">CC</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>

                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;I have children... &quot;</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">CC</span><span class="o">.</span><span class="n">executor</span><span class="p">()</span>

            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;About too get environment and with it&quot;</span><span class="p">)</span>

            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">getEnvironment</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="n">setupParams</span><span class="p">(</span><span class="n">CC</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">as</span> <span class="n">EnvObj</span><span class="p">:</span>

                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Got environment and executing with environment&quot;</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">CC</span><span class="o">.</span><span class="n">executor</span><span class="p">(</span><span class="n">EnvironmentObject</span><span class="o">=</span><span class="n">EnvObj</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
</details>
<h2 id="variables">Variables</h2>
<div class="codehilite"><pre><span></span><code><span class="n">log</span>
</code></pre></div>

<h2 id="classes">Classes</h2>
<h3 id="sshthreader">sshThreader</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">sshThreader</span><span class="p">(</span>
    <span class="n">arguments</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

<h4 id="ancestors-in-mro">Ancestors (in MRO)</h4>
<ul>
<li>sshConnector.sshEnvironmentManager.sshEnvironmentManager</li>
<li>sshConnector.sshEnvironmentControl.sshEnvironmentControl</li>
<li>sshConnector.sshBufferControl.sshBufferControl</li>
<li>sshConnector.sshConnect.sshConnect</li>
</ul>
<h4 id="class-variables">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">arguments</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">endSubRe</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">escapeChars</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">matchRe</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">promptTextTuple</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">ssh</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">startSubRe</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">tPool</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">threadDict</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">tki</span>
</code></pre></div>

<h4 id="static-methods">Static methods</h4>
<h4 id="processrootlogin">processRootLogin</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">processRootLogin</span><span class="p">(</span>
    <span class="n">loginMethod</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@staticmethod</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">processRootLogin</span><span class="p">(</span><span class="nl">loginMethod</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nf">str</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="s1">&#39;sudo&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">loginMethod</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;/usr/bin/sudo -k; /usr/bin/sudo su -&#39;</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;su -&#39;</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="instance-variables">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">EnvironmentCount</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">EnvironmentList</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">mainEnvironment</span>
</code></pre></div>

<h4 id="methods">Methods</h4>
<h4 id="addenvironment">addEnvironment</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">addEnvironment</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">channel</span><span class="p">:</span> <span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">EnvironmentControls</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

<p>Adds a provided channel to the channel manager.</p>
<ul>
<li>:param channel: (Channel) default None.</li>
<li>:param kwargs: passed into a new _ChannelObject if one is created.</li>
<li>:return: (bool)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">addEnvironment</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">channel</span><span class="p">:</span><span class="w"> </span><span class="n">EnvironmentControls</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; Adds a provided channel to the channel manager.</span>

<span class="ss">        - :param channel: (Channel) default None.</span>

<span class="ss">        - :param kwargs: passed into a new _ChannelObject if one is created.</span>

<span class="ss">        - :return: (bool)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_checkMaxSessions</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="ss">&quot;A new channel cannot be added as there already are too many channels&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">EnvironmentList</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="nf">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;ERROR: There was a failure in addEnvironment: {e}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;[DEBUG] for addEnvironment: {traceback.format_exc()}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="becomeroot">becomeRoot</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">becomeRoot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">loginCmd</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">password</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">verifyUser</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">environment</span><span class="p">:</span> <span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">sshEnvironment</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

<p>Helpful tool for quickly escalating to the root user. This method can be called without any use of it's</p>
<p>parameters as it can get these from 'self'. However, passing a specific environment is necessary to
    escalate to root on that environment.</p>
<ul>
<li>:param loginCmd: (str) default None - This is usually 'su -' or 'sudo'.</li>
<li>:param password: (str) default None - This can be filled by 'self.rootpwd' which is itself is populated by the
    value of the argument '--rootpwd'.</li>
<li>:param verifyUser: (bool) default True - This will run a whoami check after escalation to make sure the
    environment has been escalated to root. It will return False if the user escalation too root failed.</li>
<li>:param environment: (sshEnvironment) default None - replaced with 'self.mainEnvironment' if left empty.</li>
<li>:param kwargs: passed on to the escalate command.</li>
<li>:return: (bool)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">becomeRoot</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">loginCmd</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nl">password</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nl">verifyUser</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">,</span><span class="w"></span>

<span class="w">                   </span><span class="nl">environment</span><span class="p">:</span><span class="w"> </span><span class="n">sshEnvironment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; Helpful tool for quickly escalating to the root user. This method can be called without any use of it&#39;s</span>

<span class="ss">            parameters as it can get these from &#39;self&#39;. However, passing a specific environment is necessary to</span>

<span class="ss">            escalate to root on that environment.</span>

<span class="ss">        - :param loginCmd: (str) default None - This is usually &#39;su -&#39; or &#39;sudo&#39;.</span>

<span class="ss">        - :param password: (str) default None - This can be filled by &#39;self.rootpwd&#39; which is itself is populated by the</span>

<span class="ss">            value of the argument &#39;--rootpwd&#39;.</span>

<span class="ss">        - :param verifyUser: (bool) default True - This will run a whoami check after escalation to make sure the</span>

<span class="ss">            environment has been escalated to root. It will return False if the user escalation too root failed.</span>

<span class="ss">        - :param environment: (sshEnvironment) default None - replaced with &#39;self.mainEnvironment&#39; if left empty.</span>

<span class="ss">        - :param kwargs: passed on to the escalate command.</span>

<span class="ss">        - :return: (bool)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">environment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">mainEnvironment</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">loginCmd</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">loginCmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">rootLogin</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">rootpwd</span><span class="w"></span>

<span class="w">        </span><span class="n">kwargs</span><span class="o">[</span><span class="n">&#39;reCapturePrompt&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kwargs</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s1">&#39;reCapturePrompt&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">True</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Env ID: {environment._id} - Prompt: {environment.prompt} - Whoami: {environment.whoami}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">becomeUser</span><span class="p">(</span><span class="n">loginCmd</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;root&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">loginPasswd</span><span class="o">=</span><span class="n">password</span><span class="p">,</span><span class="w"> </span><span class="n">verifyUser</span><span class="o">=</span><span class="n">verifyUser</span><span class="p">,</span><span class="w"></span>

<span class="w">                        </span><span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Env ID: {environment._id} - Prompt: {environment.prompt} - Whoami: {environment.whoami}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nl">verifyUser</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">whoami</span><span class="p">(</span><span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;root&#39;</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">        </span><span class="n">environment</span><span class="p">.</span><span class="n">getPrompt</span><span class="p">(</span><span class="n">reCapturePrompt</span><span class="o">=</span><span class="k">True</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="becomeuser">becomeUser</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">becomeUser</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">loginCmd</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">userName</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">loginPasswd</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">environment</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">sshEnvironment</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">userEscalation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">verifyUser</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">reCapturePrompt</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">unsafe</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">sshEnvironment</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span>
</code></pre></div>

<p>This manages the current user and will either escalate or de-escalate to the requested user.</p>
<ul>
<li>:param loginCmd: (str) - This is typically 'su -' or 'sudo su -'. Do NOT add the username to this, since it
        will automatically be appended via the 'userName' parameter.</li>
<li>:param userName: (str) - This is appended with a space after the 'loginCmd' param.</li>
<li>:param loginPasswd: (str) default None - If not passed the login password will attempt to be populated using
        existing authentication information.</li>
<li>:param environment: (sshEnvironment) default None - The sshEnvironment that this method will act on.</li>
<li>:param userEscalation: This is a boolean that will change the behavior of becomeUser. If you want to be a user
        that you already are, the default behavior is to de-escalate to that user. This states that no
        de-escalation will occur if you want to become a user, rather it will attempt to escalate again.
        IE: login as default user ie: 'server', then escalate to root, then become 'server' again by
        logging out as root. However, if userEscalation is True it would look like server -&gt; root -&gt; server.</li>
<li>:param verifyUser: (bool) default True - Effects the behavior of becomeUser by deciding whether or not to
        check and see if the loginCmd was or was not successful when becoming the user in question. It does
        this by running the 'whoami' command and comparing the output to the 'userName' variable.</li>
<li>:param reCapturePrompt: (bool) default True - This will re-populate the 'prompt' variable in the
        sshEnvironment class with the new prompt after the escalation is complete.</li>
<li>
<p>:param unsafe: (bool) default False - This tells the sshBufferControl to run in 'unsafe' mode. This changes
        how to tell when to stop reading the buffer. It is necessary for most user escalation methods.</p>
</li>
<li>
<p>:return: Either 'sshEnvironment' (success) or False (Failure)</p>
</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">becomeUser</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">loginCmd</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">userName</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">loginPasswd</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"></span>

<span class="w">                   </span><span class="nl">environment</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">sshEnvironment</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nl">userEscalation</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span><span class="p">,</span><span class="w"> </span><span class="nl">verifyUser</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">,</span><span class="w"></span>

<span class="w">                   </span><span class="nl">reCapturePrompt</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="nl">unsafe</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">sshEnvironment, bool</span><span class="o">]</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This manages the current user and will either escalate or de-escalate to the requested user.</span>

<span class="ss">        - :param loginCmd: (str) - This is typically &#39;su -&#39; or &#39;sudo su -&#39;. Do NOT add the username to this, since it</span>

<span class="ss">                will automatically be appended via the &#39;userName&#39; parameter.</span>

<span class="ss">        - :param userName: (str) - This is appended with a space after the &#39;loginCmd&#39; param.</span>

<span class="ss">        - :param loginPasswd: (str) default None - If not passed the login password will attempt to be populated using</span>

<span class="ss">                existing authentication information.</span>

<span class="ss">        - :param environment: (sshEnvironment) default None - The sshEnvironment that this method will act on.</span>

<span class="ss">        - :param userEscalation: This is a boolean that will change the behavior of becomeUser. If you want to be a user</span>

<span class="ss">                that you already are, the default behavior is to de-escalate to that user. This states that no</span>

<span class="ss">                de-escalation will occur if you want to become a user, rather it will attempt to escalate again.</span>

<span class="ss">                IE: login as default user ie: &#39;server&#39;, then escalate to root, then become &#39;server&#39; again by</span>

<span class="ss">                logging out as root. However, if userEscalation is True it would look like server -&gt; root -&gt; server.</span>

<span class="ss">        - :param verifyUser: (bool) default True - Effects the behavior of becomeUser by deciding whether or not to</span>

<span class="ss">                check and see if the loginCmd was or was not successful when becoming the user in question. It does</span>

<span class="ss">                this by running the &#39;whoami&#39; command and comparing the output to the &#39;userName&#39; variable.</span>

<span class="ss">        - :param reCapturePrompt: (bool) default True - This will re-populate the &#39;prompt&#39; variable in the</span>

<span class="ss">                sshEnvironment class with the new prompt after the escalation is complete.</span>

<span class="ss">        - :param unsafe: (bool) default False - This tells the sshBufferControl to run in &#39;unsafe&#39; mode. This changes</span>

<span class="ss">                how to tell when to stop reading the buffer. It is necessary for most user escalation methods.</span>

<span class="ss">        - :return: Either &#39;sshEnvironment&#39; (success) or False (Failure)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="nl">strBuffer</span><span class="p">:</span><span class="w"> </span><span class="n">StringIO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StringIO</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="n">environment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">mainEnvironment</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">checkConnection</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="ss">&quot;The connection is closed!&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Checks</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">attempting</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">become</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="k">are</span><span class="p">.</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">userName</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="nl">whoami</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="ss">&quot;You are attempting to escalate to the user currently logged in as. Skipping&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Checks</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">attempting</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">become</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">simple</span><span class="w"> </span><span class="n">deescalate</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">too</span><span class="p">.</span><span class="w"> </span><span class="n">We</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="n">deescalate</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="s1">&#39;userEscalation&#39;</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">False</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">default</span><span class="p">.</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="k">true</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">logic</span><span class="w"> </span><span class="n">will</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">simply</span><span class="w"> </span><span class="n">proceed</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">normal</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">attempt</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">login</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="k">user</span><span class="p">.</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">userName</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="nl">userList</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="ss">&quot;You are attempting to escalate to a user you already have logged in as in the past. &quot;</span><span class="w"></span>

<span class="w">            </span><span class="err">#</span><span class="w">           </span><span class="ss">&quot;This is just a warning&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">userEscalation</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_becomePreviousUser</span><span class="p">(</span><span class="n">userName</span><span class="p">,</span><span class="w"> </span><span class="n">strBuffer</span><span class="p">,</span><span class="w"> </span><span class="n">environment</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">We</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">us</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="s1">&#39;-k&#39;</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">clear</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">cache</span><span class="p">.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">fixes</span><span class="w"> </span><span class="n">issues</span><span class="w"> </span><span class="k">with</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">capturing</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">prompts</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">makes</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="k">ignore</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="n">successful</span><span class="w"> </span><span class="n">attempts</span><span class="p">.</span><span class="w"></span>

<span class="w">        </span><span class="n">loginCmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">processRootLogin</span><span class="p">(</span><span class="n">loginCmd</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="n">recv_ready</span><span class="p">()</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">True</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="n">send_ready</span><span class="p">()</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">True</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="nl">closed</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">environment</span><span class="p">.</span><span class="n">get_transport</span><span class="p">().</span><span class="k">close</span><span class="p">()</span><span class="w"></span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">SSHExceptionChannel</span><span class="p">(</span><span class="s1">&#39;Unable to create SSH channel...&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">sleep</span><span class="p">(</span><span class="mf">.5</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">channel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">We</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">differently</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="ow">any</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="k">user</span><span class="p">.</span><span class="w"> </span><span class="n">We</span><span class="w"> </span><span class="s1">&#39;may&#39;</span><span class="w"> </span><span class="n">attempt</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">retry</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">a</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">login</span><span class="w"> </span><span class="n">command</span><span class="p">.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">retry</span><span class="w"> </span><span class="n">depends</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="ss">&quot;verifyUser&quot;</span><span class="w"> </span><span class="k">variable</span><span class="p">.</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="nl">prompt</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">environment</span><span class="p">.</span><span class="n">getPrompt</span><span class="p">(</span><span class="n">reCapturePrompt</span><span class="o">=</span><span class="k">True</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">channel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_escalateUser</span><span class="p">(</span><span class="n">loginCmd</span><span class="o">=</span><span class="n">loginCmd</span><span class="p">,</span><span class="w"> </span><span class="n">loginPasswd</span><span class="o">=</span><span class="n">loginPasswd</span><span class="p">,</span><span class="w"> </span><span class="n">userName</span><span class="o">=</span><span class="n">userName</span><span class="p">,</span><span class="w"></span>

<span class="w">                                         </span><span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="p">,</span><span class="w"> </span><span class="n">verifyUser</span><span class="o">=</span><span class="n">verifyUser</span><span class="p">,</span><span class="w"> </span><span class="n">buffer</span><span class="o">=</span><span class="n">strBuffer</span><span class="p">,</span><span class="w"></span>

<span class="w">                                         </span><span class="n">unsafe</span><span class="o">=</span><span class="n">unsafe</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="n">BecomeUserException</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">arguments</span><span class="p">.</span><span class="nl">rootLoginExplicit</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">e</span><span class="w"></span>

<span class="w">            </span><span class="nf">log</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Unable to become user will try again: {e}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="s1">&#39;sudo&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">loginCmd</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="nf">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Failed to escalate to user: {userName} with command: {loginCmd}. Trying command: &#39;su -&#39;&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">_clearLoginAttempt</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="n">channel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_escalateUser</span><span class="p">(</span><span class="n">loginCmd</span><span class="o">=</span><span class="s1">&#39;su -&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">loginPasswd</span><span class="o">=</span><span class="n">loginPasswd</span><span class="p">,</span><span class="w"> </span><span class="n">userName</span><span class="o">=</span><span class="n">userName</span><span class="p">,</span><span class="w"></span>

<span class="w">                                             </span><span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="p">,</span><span class="w"> </span><span class="n">verifyUser</span><span class="o">=</span><span class="n">verifyUser</span><span class="p">,</span><span class="w"> </span><span class="n">buffer</span><span class="o">=</span><span class="n">strBuffer</span><span class="p">,</span><span class="w"></span>

<span class="w">                                             </span><span class="n">unsafe</span><span class="o">=</span><span class="n">unsafe</span><span class="p">,</span><span class="w"> </span><span class="n">prompt</span><span class="o">=</span><span class="n">environment</span><span class="p">.</span><span class="n">prompt</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">elif</span><span class="w"> </span><span class="s1">&#39;su -&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">loginCmd</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">newLoginCmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;/usr/bin/sudo -k; /usr/bin/sudo su -&#39;</span><span class="w"></span>

<span class="w">                </span><span class="nf">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Failed to escalate to user: {userName} with command: {loginCmd}. &quot;</span><span class="w"></span>

<span class="w">                         </span><span class="n">f</span><span class="ss">&quot;Trying command: {newLoginCmd}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">_clearLoginAttempt</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="n">channel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_escalateUser</span><span class="p">(</span><span class="n">loginCmd</span><span class="o">=</span><span class="n">newLoginCmd</span><span class="p">,</span><span class="w"> </span><span class="n">loginPasswd</span><span class="o">=</span><span class="n">loginPasswd</span><span class="p">,</span><span class="w"> </span><span class="n">userName</span><span class="o">=</span><span class="n">userName</span><span class="p">,</span><span class="w"></span>

<span class="w">                                             </span><span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="p">,</span><span class="w"> </span><span class="n">verifyUser</span><span class="o">=</span><span class="n">verifyUser</span><span class="p">,</span><span class="w"> </span><span class="n">buffer</span><span class="o">=</span><span class="n">strBuffer</span><span class="p">,</span><span class="w"></span>

<span class="w">                                             </span><span class="n">unsafe</span><span class="o">=</span><span class="n">unsafe</span><span class="p">,</span><span class="w"> </span><span class="n">prompt</span><span class="o">=</span><span class="n">environment</span><span class="p">.</span><span class="n">prompt</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="nf">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Unknown ERROR while user escalation: {e}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;[DEBUG]: {traceback.format_exc()}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="nl">finally</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="n">isPromptDefault</span><span class="p">(</span><span class="n">reCapturePrompt</span><span class="o">=</span><span class="n">reCapturePrompt</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">reCapturePrompt</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">arguments</span><span class="p">.</span><span class="nl">useBashnorc</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">self</span><span class="p">.</span><span class="n">escalate</span><span class="p">(</span><span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="p">,</span><span class="w"> </span><span class="n">escalationCmd</span><span class="o">=</span><span class="s1">&#39;bash&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">escalationArgs</span><span class="o">=</span><span class="s1">&#39;-norc&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;BASH&#39;</span><span class="p">,</span><span class="w"></span>

<span class="w">                                  </span><span class="n">console</span><span class="o">=</span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="n">unsafe</span><span class="o">=</span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="n">reCapturePrompt</span><span class="o">=</span><span class="k">True</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="n">getPrompt</span><span class="p">(</span><span class="n">reCapturePrompt</span><span class="o">=</span><span class="n">reCapturePrompt</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">environment</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="checkconnection">checkConnection</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">checkConnection</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">sshChannel</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">paramiko</span><span class="o">.</span><span class="n">channel</span><span class="o">.</span><span class="n">Channel</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

<p>Creates ssh key object or returns None.</p>
<ul>
<li>:param: (Channel): None or Paramiko channel</li>
<li>:return: (bool)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">checkConnection</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">sshChannel</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Channel</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; Creates ssh key object or returns None.</span>

<span class="ss">        - :param: (Channel): None or Paramiko channel</span>

<span class="ss">        - :return: (bool)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">sshChannel</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">sshChannel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">mainEnvironment</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">ssh</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">sshChannel</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">sshChannel</span><span class="p">.</span><span class="n">get_transport</span><span class="p">().</span><span class="n">is_active</span><span class="p">()</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">sshChannel</span><span class="p">.</span><span class="n">closed</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="checkwhoami">checkWhoAmI</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">checkWhoAmI</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">environment</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">sshEnvironment</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

<p>This is the slow but sure fire way to find out what the current user is. This function can be called with a</p>
<p>custom channel to determine the user of that channel. If calling from a thread it is required that you pass
    the channel or else you will get the whoami information for the master channel.
    Note: When called from a thread this function runs the command directly on the sshCommand buffer. This means
    that the calling thread has to wait until this is complete. Keep that in mind when using this function.</p>
<ul>
<li>:param environment: (sshEnvironment) default None -</li>
<li>:return: (str)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">checkWhoAmI</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">environment</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">sshEnvironment</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nf">str</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This is the slow but sure fire way to find out what the current user is. This function can be called with a</span>

<span class="ss">            custom channel to determine the user of that channel. If calling from a thread it is required that you pass</span>

<span class="ss">            the channel or else you will get the whoami information for the master channel.</span>

<span class="ss">            Note: When called from a thread this function runs the command directly on the sshCommand buffer. This means</span>

<span class="ss">            that the calling thread has to wait until this is complete. Keep that in mind when using this function.</span>

<span class="ss">        - :param environment: (sshEnvironment) default None -</span>

<span class="ss">        - :return: (str)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">_checkWhoAmIHelper</span><span class="p">(</span><span class="n">cmdResults</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nf">str</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">cmdOutputRe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sshEnvironmentControl</span><span class="p">.</span><span class="n">matchRe</span><span class="p">.</span><span class="k">search</span><span class="p">(</span><span class="w"></span>

<span class="w">                    </span><span class="n">sshEnvironmentControl</span><span class="p">.</span><span class="n">startSubRe</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">cmdResults</span><span class="p">,</span><span class="w"> </span><span class="nf">count</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="nl">cmdOutputRe</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">sshEnvironmentControl</span><span class="p">.</span><span class="n">endSubRe</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">cmdOutputRe</span><span class="p">.</span><span class="k">group</span><span class="p">(),</span><span class="w"> </span><span class="nf">count</span><span class="o">=</span><span class="mi">1</span><span class="p">).</span><span class="n">strip</span><span class="p">()</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"></span>

<span class="w">            </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="nf">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;error in _checkWhoAmIHelper: {e}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[DEBUG] for _checkWhoAmIHelper: {traceback.format_exc()}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">_checkWhoAmIHelper</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">executeOnEnvironment</span><span class="p">(</span><span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">mainEnvironment</span><span class="p">,</span><span class="w"></span>

<span class="w">                                                            </span><span class="n">cmd</span><span class="o">=</span><span class="s1">&#39;echo CMDSTART; whoami; echo CMDEND&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">prompt</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">))</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="consoleescalation">consoleEscalation</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">consoleEscalation</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">escalationCmd</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">escalationArgs</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="n">escalationInput</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">escalationType</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;console&#39;</span><span class="p">,</span>
    <span class="n">escalationHook</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">environment</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">sshEnvironment</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">sshEnvironment</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span>
</code></pre></div>

<p>This function differs from 'becomeUser' as it designed to change the environment from BASH to for example</p>
<p>mysql shell or a sqlpluss shell.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>escalationCmd</td>
<td>None</td>
<td>(str) - The command such as sqlpluss or zsh</td>
<td>None</td>
</tr>
<tr>
<td>escalationArgs</td>
<td>None</td>
<td>(str) default "" - Additional args such as '-h localhost'.</td>
<td>None</td>
</tr>
<tr>
<td>escalationInput</td>
<td>None</td>
<td>(str) default None - This is used if the command will require input such as a password.</td>
<td>None</td>
</tr>
<tr>
<td>escalationType</td>
<td>None</td>
<td>(str) default "console" - This is used to record the escalation type in sshEnvironment.</td>
<td>None</td>
</tr>
<tr>
<td>escalationHook</td>
<td>None</td>
<td>(Callable) default None - a method to call instead of the default escalation method.</td>
<td>None</td>
</tr>
<tr>
<td>name</td>
<td>None</td>
<td>(str) defualt None - What to call this console change. This can be useful when searching if a</td>
<td></td>
</tr>
<tr>
<td>sshEnvironment has already escalated to a specific environment.</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>environment</td>
<td>None</td>
<td>sshEnvironment object</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>Either 'sshEnvironment' (success) or False (Failure)</td>
</tr>
</tbody>
</table>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">consoleEscalation</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">escalationCmd</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">escalationArgs</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="nl">escalationInput</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"></span>

<span class="w">                          </span><span class="nl">escalationType</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;console&quot;</span><span class="p">,</span><span class="w"> </span><span class="nl">escalationHook</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Callable</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"></span>

<span class="w">                          </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nl">environment</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">sshEnvironment</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"></span>

<span class="w">                          </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">sshEnvironment, bool</span><span class="o">]</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This function differs from &#39;becomeUser&#39; as it designed to change the environment from BASH to for example</span>

<span class="ss">            mysql shell or a sqlpluss shell.</span>

<span class="ss">        :param escalationCmd: (str) - The command such as sqlpluss or zsh</span>

<span class="ss">        :param escalationArgs: (str) default &quot;&quot; - Additional args such as &#39;-h localhost&#39;.</span>

<span class="ss">        :param escalationInput: (str) default None - This is used if the command will require input such as a password.</span>

<span class="ss">        :param escalationType: (str) default &quot;</span><span class="n">console</span><span class="ss">&quot; - This is used to record the escalation type in sshEnvironment.</span>

<span class="ss">        :param escalationHook: (Callable) default None - a method to call instead of the default escalation method.</span>

<span class="ss">        :param name: (str) defualt None - What to call this console change. This can be useful when searching if a</span>

<span class="ss">                sshEnvironment has already escalated to a specific environment.</span>

<span class="ss">        :param environment: sshEnvironment object</span>

<span class="ss">        :return: Either &#39;sshEnvironment&#39; (success) or False (Failure)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">reCapturePrompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kwargs</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s1">&#39;reCapturePrompt&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">True</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="nl">strBuffer</span><span class="p">:</span><span class="w"> </span><span class="n">StringIO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StringIO</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="n">environment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">mainEnvironment</span><span class="w"></span>

<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="n">recv_ready</span><span class="p">()</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">True</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="n">send_ready</span><span class="p">()</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">True</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="nl">closed</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">environment</span><span class="p">.</span><span class="n">get_transport</span><span class="p">().</span><span class="k">close</span><span class="p">()</span><span class="w"></span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">SSHExceptionChannel</span><span class="p">(</span><span class="s1">&#39;Unable to create SSH channel...&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">sleep</span><span class="p">(</span><span class="mf">.5</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">escalationCmd</span><span class="w"></span>

<span class="w">        </span><span class="n">environment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_performEscalation</span><span class="p">(</span><span class="n">environment</span><span class="p">,</span><span class="w"> </span><span class="n">loginCmd</span><span class="o">=</span><span class="n">escalationCmd</span><span class="p">,</span><span class="w"> </span><span class="n">loginPasswd</span><span class="o">=</span><span class="n">escalationInput</span><span class="p">,</span><span class="w"></span>

<span class="w">                                              </span><span class="n">userName</span><span class="o">=</span><span class="n">escalationArgs</span><span class="p">,</span><span class="w"> </span><span class="n">buffer</span><span class="o">=</span><span class="n">strBuffer</span><span class="p">,</span><span class="w"> </span><span class="n">console</span><span class="o">=</span><span class="k">True</span><span class="p">,</span><span class="w"></span>

<span class="w">                                              </span><span class="n">escalationHook</span><span class="o">=</span><span class="n">escalationHook</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">environment</span><span class="p">.</span><span class="n">getPrompt</span><span class="p">(</span><span class="n">reCapturePrompt</span><span class="o">=</span><span class="n">reCapturePrompt</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">environment</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">escalationCmd</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">escalationArgs</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">additionalInput</span><span class="o">=</span><span class="n">escalationInput</span><span class="p">,</span><span class="w"></span>

<span class="w">                         </span><span class="n">escalationType</span><span class="o">=</span><span class="n">escalationType</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">environment</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="createconn">createConn</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">createConn</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="o">~</span><span class="n">AnyStr</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">username</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="o">~</span><span class="n">AnyStr</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">password</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="o">~</span><span class="n">AnyStr</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">connTimeout</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">paramiko</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">SSHClient</span>
</code></pre></div>

<p>Creates SSH Object and Opens Connection To Server All the parameters are optional. If a parameter isn't</p>
<p>passed it will pull from the Class variable of the same name. If the parameter is passed it will override
    the class variable before connecting.</p>
<ul>
<li>:param host: (str) - Optional hostname/ip address of the box.</li>
<li>:param port: (int) - Optional port to attempt to make the tcp connection.</li>
<li>:param username: (str) - Optional and will use the class stored variable if not passed.</li>
<li>:param password: (str) - Optional and will use the class stored variable if not passed.</li>
<li>:param connTimeout: (float) - Optional and will use the class stored variable if not passed.</li>
<li>:return: Paramiko SSHClient object. Otherwise known as SSH Connection.</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">createConn</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">host</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">AnyStr</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nl">port</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">int</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nl">username</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">AnyStr</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"></span>

<span class="w">                   </span><span class="nl">password</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">AnyStr</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nl">connTimeout</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">float</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">SSHClient</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; Creates SSH Object and Opens Connection To Server All the parameters are optional. If a parameter isn&#39;t</span>

<span class="ss">            passed it will pull from the Class variable of the same name. If the parameter is passed it will override</span>

<span class="ss">            the class variable before connecting.</span>

<span class="ss">        - :param host: (str) - Optional hostname/ip address of the box.</span>

<span class="ss">        - :param port: (int) - Optional port to attempt to make the tcp connection.</span>

<span class="ss">        - :param username: (str) - Optional and will use the class stored variable if not passed.</span>

<span class="ss">        - :param password: (str) - Optional and will use the class stored variable if not passed.</span>

<span class="ss">        - :param connTimeout: (float) - Optional and will use the class stored variable if not passed.</span>

<span class="ss">        - :return: Paramiko SSHClient object. Otherwise known as SSH Connection.</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">ssh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">ssh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paramiko</span><span class="p">.</span><span class="n">SSHClient</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="n">ssh</span><span class="p">.</span><span class="n">set_missing_host_key_policy</span><span class="p">(</span><span class="n">paramiko</span><span class="p">.</span><span class="n">AutoAddPolicy</span><span class="p">())</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="k">host</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="k">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">host</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nl">port</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">port</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nl">username</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">username</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nl">password</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">password</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nl">connTimeout</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">connTimeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">connTimeout</span><span class="w"></span>

<span class="w">            </span><span class="n">ssh</span><span class="p">.</span><span class="k">connect</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="k">host</span><span class="p">,</span><span class="w"></span>

<span class="w">                        </span><span class="n">port</span><span class="o">=</span><span class="nc">int</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">port</span><span class="p">),</span><span class="w"></span>

<span class="w">                        </span><span class="n">pkey</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">_handleSSHKey</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">password</span><span class="p">),</span><span class="w"></span>

<span class="w">                        </span><span class="n">username</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">username</span><span class="p">,</span><span class="w"></span>

<span class="w">                        </span><span class="n">password</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">password</span><span class="p">,</span><span class="w"></span>

<span class="w">                        </span><span class="n">timeout</span><span class="o">=</span><span class="nc">float</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">connTimeout</span><span class="p">),</span><span class="w"></span>

<span class="w">                        </span><span class="n">look_for_keys</span><span class="o">=</span><span class="k">False</span><span class="p">,</span><span class="w"></span>

<span class="w">                        </span><span class="n">banner_timeout</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span><span class="w"></span>

<span class="w">                        </span><span class="n">sock</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">_makeSockProxy</span><span class="p">())</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="n">socket</span><span class="p">.</span><span class="n">error</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nl">ssh</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">ssh</span><span class="p">.</span><span class="k">close</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">LDTKSSHException</span><span class="p">(</span><span class="s1">&#39;Connection Error for User %s: %s&#39;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">))</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">e</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="p">(</span><span class="n">paramiko</span><span class="p">.</span><span class="n">AuthenticationException</span><span class="p">,</span><span class="w"> </span><span class="n">paramiko</span><span class="p">.</span><span class="n">BadAuthenticationType</span><span class="p">,</span><span class="w"> </span><span class="n">paramiko</span><span class="p">.</span><span class="n">BadHostKeyException</span><span class="p">,</span><span class="w"></span>

<span class="w">                </span><span class="n">paramiko</span><span class="p">.</span><span class="n">PasswordRequiredException</span><span class="p">,</span><span class="w"> </span><span class="n">paramiko</span><span class="p">.</span><span class="n">ssh_exception</span><span class="p">.</span><span class="n">PartialAuthentication</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nl">ssh</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">ssh</span><span class="p">.</span><span class="k">close</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">SSHExceptionAuth</span><span class="p">(</span><span class="s1">&#39;Authentication Error for User %s: %s&#39;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">))</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">e</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="p">(</span><span class="n">paramiko</span><span class="p">.</span><span class="n">ssh_exception</span><span class="p">.</span><span class="n">ConfigParseError</span><span class="p">,</span><span class="w"> </span><span class="n">paramiko</span><span class="p">.</span><span class="n">ProxyCommandFailure</span><span class="p">,</span><span class="w"></span>

<span class="w">                </span><span class="n">paramiko</span><span class="p">.</span><span class="n">ssh_exception</span><span class="p">.</span><span class="n">CouldNotCanonicalize</span><span class="p">,</span><span class="w"> </span><span class="n">paramiko</span><span class="p">.</span><span class="n">ssh_exception</span><span class="p">.</span><span class="n">NoValidConnectionsError</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">SSHExceptionConn</span><span class="p">(</span><span class="s1">&#39;Could not connect to remove machine for User %s: %s&#39;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">))</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">e</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="n">paramiko</span><span class="p">.</span><span class="n">SSHException</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nl">ssh</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">ssh</span><span class="p">.</span><span class="k">close</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">SSHExceptionUnknown</span><span class="p">(</span><span class="s1">&#39;Generic Paramiko Exception for User %s: %s&#39;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">))</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">e</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nl">ssh</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">ssh</span><span class="p">.</span><span class="k">close</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">LDTKSSHException</span><span class="p">(</span><span class="s1">&#39;Unknown Error for User %s: %s&#39;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">))</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">e</span><span class="w"></span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">ssh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ssh</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">ssh</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="createenvironment">createEnvironment</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">createEnvironment</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">EnvironmentControls</span><span class="p">]</span>
</code></pre></div>

<p>Used to create a new channel.</p>
<ul>
<li>:param maxChannels: (int) default (whatever the _MAX_CHANNEL class variable is set to). This is passed directly
    to '_checkMaxChannels'. This can temporarily override the _MAX_CHANNEL setting.</li>
<li>:param autoAdd: (bool) default True: determines if the 'addChannel' method will be called to add the new channel</li>
<li>:param toBeUsed: (bool) default True: This is actually a _ChannelContainer object param but it is important here
    as it can be sued to control weather or not the new object will be available for use by the calling thread
    or can immediately be available for other threads to use.</li>
<li>:param kwargs:</li>
<li>:return:</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">createEnvironment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="nb nb-Type">bool</span><span class="p">,</span><span class="w"> </span><span class="n">EnvironmentControls</span><span class="p">]:</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; Used to create a new channel.</span>

<span class="sd">        - :param maxChannels: (int) default (whatever the _MAX_CHANNEL class variable is set to). This is passed directly</span>

<span class="sd">            to &#39;_checkMaxChannels&#39;. This can temporarily override the _MAX_CHANNEL setting.</span>

<span class="sd">        - :param autoAdd: (bool) default True: determines if the &#39;addChannel&#39; method will be called to add the new channel</span>

<span class="sd">        - :param toBeUsed: (bool) default True: This is actually a _ChannelContainer object param but it is important here</span>

<span class="sd">            as it can be sued to control weather or not the new object will be available for use by the calling thread</span>

<span class="sd">            or can immediately be available for other threads to use.</span>

<span class="sd">        - :param kwargs:</span>

<span class="sd">        - :return:</span>

<span class="sd">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_checkMaxSessions</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span><span class="w"></span>

<span class="w">            </span><span class="nb">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;A new channel cannot be made as there already are too many channels&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">False</span><span class="w"></span>

<span class="w">        </span><span class="n">autoAdd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;autoAdd&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">True</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">EnvObj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_openChannel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainEnvironment</span><span class="o">.</span><span class="n">get_transport</span><span class="p">())</span><span class="w"></span>

<span class="w">        </span><span class="n">EnvObj</span><span class="o">.</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">EnvObj</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s2">&quot;su -&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arguments</span><span class="o">.</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">additionalInput</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arguments</span><span class="o">.</span><span class="n">password</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">arguments</span><span class="o">.</span><span class="n">root</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">EnvObj</span><span class="o">.</span><span class="n">becomeRoot</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="k">else</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">EnvObj</span><span class="o">.</span><span class="n">escalate</span><span class="p">(</span><span class="n">escalationCmd</span><span class="o">=</span><span class="s1">&#39;bash&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">escalationArgs</span><span class="o">=</span><span class="s1">&#39;-norc&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;BASH&#39;</span><span class="p">,</span><span class="w"></span>

<span class="w">                            </span><span class="n">console</span><span class="o">=</span><span class="n">True</span><span class="p">,</span><span class="w"> </span><span class="n">unsafe</span><span class="o">=</span><span class="n">True</span><span class="p">,</span><span class="w"> </span><span class="n">reCapturePrompt</span><span class="o">=</span><span class="n">True</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">autoAdd</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">addEnvironment</span><span class="p">(</span><span class="n">EnvObj</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">EnvObj</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="disconnect">disconnect</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">disconnect</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">environment</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">sshEnvironment</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>This attempts to graceful log out by exiting/de-escalating through all previous console escalations on a</p>
<p>given sshEnvironment.</p>
<ul>
<li>:param environment: (sshEnvironment) default None -</li>
<li>:return: None</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">disconnect</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">environment</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">sshEnvironment</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This attempts to graceful log out by exiting/de-escalating through all previous console escalations on a</span>

<span class="ss">            given sshEnvironment.</span>

<span class="ss">        - :param environment: (sshEnvironment) default None -</span>

<span class="ss">        - :return: None</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">environment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">mainEnvironment</span><span class="w"></span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="n">environment</span><span class="p">.</span><span class="n">numEscalations</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">logoutCurrentUser</span><span class="p">(</span><span class="n">environment</span><span class="p">,</span><span class="w"> </span><span class="n">reCapturePrompt</span><span class="o">=</span><span class="k">False</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="nl">isMain</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">super</span><span class="p">(</span><span class="n">sshEnvironmentControl</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">).</span><span class="k">disconnect</span><span class="p">()</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="disconnectenvironments">disconnectEnvironments</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">disconnectEnvironments</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Disconnects all Environments. Used as a single thread alternative to 'threadedDisconnect' from 'sshThreader'</p>
<ul>
<li>:return:</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">disconnectEnvironments</span><span class="p">(</span><span class="kr">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">None</span><span class="o">:</span><span class="w"></span>

<span class="w">        </span><span class="s">&quot;&quot;&quot; Disconnects all Environments. Used as a single thread alternative to &#39;</span><span class="n">threadedDisconnect</span><span class="s">&#39; from &#39;</span><span class="n">sshThreader</span><span class="s">&#39;</span>

<span class="s">        - :return:</span>

<span class="s">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">with</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">_ENVIRONMENT_LIST_LOCK</span><span class="o">:</span><span class="w"></span>

<span class="w">            </span><span class="n">for</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="p">[</span><span class="n">env</span><span class="w"> </span><span class="n">for</span><span class="w"> </span><span class="n">env</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">EnvironmentList</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="kr">not</span><span class="w"> </span><span class="n">env</span><span class="p">.</span><span class="n">isMain</span><span class="p">]</span><span class="o">:</span><span class="w"></span>

<span class="w">                </span><span class="n">environment</span><span class="p">.</span><span class="n">disconnectEnvironment</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="kr">self</span><span class="p">.</span><span class="n">mainEnvironment</span><span class="p">.</span><span class="n">disconnectEnvironment</span><span class="p">()</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="environmentchange">environmentChange</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">environmentChange</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">sshEnvironment</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span>
</code></pre></div>

<p>Changes the state of the environment in some way other then user or console escalation. This method</p>
<p>depends on 'consoleEscalation'. It simply adjusted the 'escalationType' and 'reCapturePrompt' parameters
    to work for changing the environment. This method is helpful if you want to record the fact that this
    sshEnvironment has special variables/settings set. Such as editing its PATH or the use of export. That way
    it is easy to run future commands on that particular environment.</p>
<ul>
<li>:param: args - Passed to 'consoleEscalation'</li>
<li>:param: kwargs - Passed to 'consoleEscalation'</li>
<li>:return: Either 'sshEnvironment' (success) or False (Failure)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">environmentChange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="n">sshEnvironment</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="p">]:</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; Changes the state of the environment in some way other then user or console escalation. This method</span>

<span class="sd">            depends on &#39;consoleEscalation&#39;. It simply adjusted the &#39;escalationType&#39; and &#39;reCapturePrompt&#39; parameters</span>

<span class="sd">            to work for changing the environment. This method is helpful if you want to record the fact that this</span>

<span class="sd">            sshEnvironment has special variables/settings set. Such as editing its PATH or the use of export. That way</span>

<span class="sd">            it is easy to run future commands on that particular environment.</span>

<span class="sd">        - :param: args - Passed to &#39;consoleEscalation&#39;</span>

<span class="sd">        - :param: kwargs - Passed to &#39;consoleEscalation&#39;</span>

<span class="sd">        - :return: Either &#39;sshEnvironment&#39; (success) or False (Failure)</span>

<span class="sd">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;escalationType&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;env&#39;</span><span class="w"></span>

<span class="w">        </span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;reCapturePrompt&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;reCapturePrompt&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">False</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">consoleEscalation</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="escalate">escalate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">escalate</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">env</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">console</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">sshEnvironment</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span>
</code></pre></div>

<p>The default escalation method. This can handle console or environment changes. It uses the console</p>
<p>and env bool parameters to control what type of console change will happen. If both are false the method
    will call the 'becomeUser' method.</p>
<ul>
<li>:param args: (tuple) - passed on</li>
<li>:param env: (bool) default False - This will be checked first and will call 'environmentChange' method.</li>
<li>:param console: (bool) default False - This will be checked second and will call 'consoleEscalation' method.</li>
<li>:param kwargs: (dict) - passed on</li>
<li>:return: Either 'sshEnvironment' (success) or False (Failure)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">escalate</span><span class="p">(</span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">env</span><span class="o">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">False</span><span class="p">,</span><span class="w"> </span><span class="n">console</span><span class="o">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">False</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="n">sshEnvironment</span><span class="p">,</span><span class="w"> </span><span class="n">bool</span><span class="p">]</span><span class="o">:</span><span class="w"></span>

<span class="w">        </span><span class="s">&quot;&quot;&quot; The default escalation method. This can handle console or environment changes. It uses the console</span>

<span class="s">            and env bool parameters to control what type of console change will happen. If both are false the method</span>

<span class="s">            will call the &#39;</span><span class="n">becomeUser</span><span class="s">&#39; method.</span>

<span class="s">        - :param args: (tuple) - passed on</span>

<span class="s">        - :param env: (bool) default False - This will be checked first and will call &#39;</span><span class="n">environmentChange</span><span class="s">&#39; method.</span>

<span class="s">        - :param console: (bool) default False - This will be checked second and will call &#39;</span><span class="n">consoleEscalation</span><span class="s">&#39; method.</span>

<span class="s">        - :param kwargs: (dict) - passed on</span>

<span class="s">        - :return: Either &#39;</span><span class="n">sshEnvironment</span><span class="s">&#39; (success) or False (Failure)</span>

<span class="s">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="nf">if</span><span class="w"> </span><span class="n">kwargs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;environment&#39;</span><span class="p">,</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">mainEnvironment</span><span class="p">)</span><span class="o">:</span><span class="w"></span>

<span class="w">            </span><span class="nf">if</span><span class="w"> </span><span class="n">env</span><span class="o">:</span><span class="w"></span>

<span class="w">                </span><span class="kr">return</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">environmentChange</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">elif</span><span class="w"> </span><span class="n">console</span><span class="o">:</span><span class="w"></span>

<span class="w">                </span><span class="kr">return</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">consoleEscalation</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">else</span><span class="o">:</span><span class="w"></span>

<span class="w">                </span><span class="kr">return</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">becomeUser</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="kr">False</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="executeonenvironment">executeOnEnvironment</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">executeOnEnvironment</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">environment</span><span class="p">:</span> <span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">EnvironmentControls</span><span class="p">,</span>
    <span class="n">cmd</span><span class="p">:</span> <span class="o">~</span><span class="n">AnyStr</span><span class="p">,</span>
    <span class="n">prompt</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="o">~</span><span class="n">AnyStr</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">unsafe</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">reCapturePrompt</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="o">~</span><span class="n">AnyStr</span>
</code></pre></div>

<p>This injects the string into the buffer while trying to ensure there is a prompt. As the prompt is used to</p>
<p>quickly determine the end of the buffer. The prompt can be a string or it can be a tuple of strings that
    attempt to match the end of the line. Unsafe ignores the prompt and simply executes the command and only
    waits a short time before leaving not caring if it got output of the command. This is unsafe as it can leave
    a buffer open ready to dump more output. This method also takes the output from the command and attempts to
    decode it to utf-8 while removing all null and escape characters.</p>
<ul>
<li>:param channel: (Paramiko Channel/sshEnvironment) -</li>
<li>:param cmd: (str) -</li>
<li>:param prompt: (tuple or str) -</li>
<li>:param unsafe: (bool) default False -</li>
<li>:param kwargs:</li>
<li>:return: (str)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">executeOnEnvironment</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">environment</span><span class="p">:</span><span class="w"> </span><span class="n">EnvironmentControls</span><span class="p">,</span><span class="w"> </span><span class="nl">cmd</span><span class="p">:</span><span class="w"> </span><span class="n">AnyStr</span><span class="p">,</span><span class="w"></span>

<span class="w">                             </span><span class="nl">prompt</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Union[AnyStr, Tuple</span><span class="o">]</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nl">unsafe</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span><span class="p">,</span><span class="w"></span>

<span class="w">                             </span><span class="nl">reCapturePrompt</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">AnyStr</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This injects the string into the buffer while trying to ensure there is a prompt. As the prompt is used to</span>

<span class="ss">            quickly determine the end of the buffer. The prompt can be a string or it can be a tuple of strings that</span>

<span class="ss">            attempt to match the end of the line. Unsafe ignores the prompt and simply executes the command and only</span>

<span class="ss">            waits a short time before leaving not caring if it got output of the command. This is unsafe as it can leave</span>

<span class="ss">            a buffer open ready to dump more output. This method also takes the output from the command and attempts to</span>

<span class="ss">            decode it to utf-8 while removing all null and escape characters.</span>

<span class="ss">        - :param channel: (Paramiko Channel/sshEnvironment) -</span>

<span class="ss">        - :param cmd: (str) -</span>

<span class="ss">        - :param prompt: (tuple or str) -</span>

<span class="ss">        - :param unsafe: (bool) default False -</span>

<span class="ss">        - :param kwargs:</span>

<span class="ss">        - :return: (str)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">_parseOutput</span><span class="p">(</span><span class="n">tmpOut</span><span class="p">,</span><span class="w"> </span><span class="n">tmpPrompt</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">tmpOut</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sshBufferControl</span><span class="p">.</span><span class="n">_decodeStringEscape</span><span class="p">(</span><span class="n">tmpOut</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">tmpOut</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sshBufferControl</span><span class="p">.</span><span class="n">escapeChars</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">tmpOut</span><span class="p">).</span><span class="n">strip</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">tmpOut</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="n">tmpPrompt</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nf">replace</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">).</span><span class="n">strip</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">super</span><span class="p">(</span><span class="n">sshBufferControl</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">).</span><span class="n">checkConnection</span><span class="p">(</span><span class="n">sshChannel</span><span class="o">=</span><span class="n">environment</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="nf">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="ss">&quot;There is not valid connection.&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"></span>

<span class="w">        </span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Attempting to exec command[s]: {cmd}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StringIO</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="k">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span><span class="w"> </span><span class="nf">str</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sshBufferControl</span><span class="p">.</span><span class="n">_decodeStringEscape</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">prompt</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">unsafe</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">False</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="n">getPrompt</span><span class="p">(</span><span class="n">reCapturePrompt</span><span class="o">=</span><span class="n">reCapturePrompt</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">_bufferControl</span><span class="p">(</span><span class="n">environment</span><span class="p">,</span><span class="w"> </span><span class="n">cmd</span><span class="p">,</span><span class="w"> </span><span class="k">out</span><span class="p">,</span><span class="w"> </span><span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">,</span><span class="w"> </span><span class="n">unsafe</span><span class="o">=</span><span class="n">unsafe</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_parseOutput</span><span class="p">(</span><span class="k">out</span><span class="p">.</span><span class="n">getvalue</span><span class="p">(),</span><span class="w"> </span><span class="n">prompt</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="n">RecvReady</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="nf">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;The timeout of {self.runTimeout} was reached while waiting for prompt on buffer.&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;[DEBUG] for executeOnEnvironment: {traceback.format_exc()}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_parseOutput</span><span class="p">(</span><span class="k">out</span><span class="p">.</span><span class="n">getvalue</span><span class="p">(),</span><span class="w"> </span><span class="n">prompt</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">environment</span><span class="p">.</span><span class="k">close</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="n">socket</span><span class="p">.</span><span class="nl">timeout</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="nf">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="ss">&quot;Timeout exception found.&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;[COMMAND_IO_LIMIT_TIMED_OUT]&#39;</span><span class="w"></span>

<span class="w">            </span><span class="n">environment</span><span class="p">.</span><span class="k">close</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="nl">finally</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">out</span><span class="p">.</span><span class="k">truncate</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">del</span><span class="w"> </span><span class="k">out</span><span class="w"></span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;The output of the cmd: {cmd} is: \n===\n{output}\n===&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">output</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="executeonthread">executeOnThread</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">executeOnThread</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">cmd</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">LinuxModules</span><span class="o">.</span><span class="n">CommandContainers</span><span class="o">.</span><span class="n">CommandContainer</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">EnvObj</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">EnvironmentControls</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LinuxModules</span><span class="o">.</span><span class="n">CommandContainers</span><span class="o">.</span><span class="n">CommandContainer</span>
</code></pre></div>

<p>Submits a new command to be executed via the 'submit' method in Pool. All commands ran should be within a</p>
<p>CommandContainer. So the method first checks to see if the command is already a Container or not.</p>
<ul>
<li>:param CC: [Either a CommandContainer or Any other datatype]</li>
<li>:param EnvObj: (EnvironmentControls) default None. This specifies a Channel to run the command on. This
      bypasses using a Thread and instead expects that the channelObject is already 'active' or 'taken' by the
      thread currently calling this method.</li>
<li>:param kwargs: used to create a new CommandContainer is 'cmd' is not a CommandContainer</li>
<li>:return: CommandContainer (The same container that either was submitted as the cmd or the one created)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">executeOnThread</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">cmd</span><span class="p">:</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">CommandContainer, Any</span><span class="o">]</span><span class="p">,</span><span class="w"></span>

<span class="w">                        </span><span class="nl">EnvObj</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">EnvironmentControls</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">CommandContainer</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; Submits a new command to be executed via the &#39;submit&#39; method in Pool. All commands ran should be within a</span>

<span class="ss">            CommandContainer. So the method first checks to see if the command is already a Container or not.</span>

<span class="ss">        - :param CC: [Either a CommandContainer or Any other datatype]</span>

<span class="ss">        - :param EnvObj: (EnvironmentControls) default None. This specifies a Channel to run the command on. This</span>

<span class="ss">              bypasses using a Thread and instead expects that the channelObject is already &#39;active&#39; or &#39;taken&#39; by the</span>

<span class="ss">              thread currently calling this method.</span>

<span class="ss">        - :param kwargs: used to create a new CommandContainer is &#39;cmd&#39; is not a CommandContainer</span>

<span class="ss">        - :return: CommandContainer (The same container that either was submitted as the cmd or the one created)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">_preparserCmd</span><span class="p">(</span><span class="n">commands</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">commands</span><span class="p">,</span><span class="w"> </span><span class="n">CommandContainer</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">commands</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="s1">&#39;commandKey&#39;</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">kwargs</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">kwargs</span><span class="o">[</span><span class="n">&#39;commandKey&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="s1">&#39;tki&#39;</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">kwargs</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tki</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">kwargs</span><span class="o">[</span><span class="n">&#39;tki&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tki</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">CommandContainer</span><span class="p">(</span><span class="n">commands</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">CC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_preparserCmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">EnvObj</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">tPool</span><span class="p">.</span><span class="n">submit</span><span class="p">(</span><span class="n">fn</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">_exeThread</span><span class="p">,</span><span class="w"> </span><span class="n">CC</span><span class="o">=</span><span class="n">CC</span><span class="p">,</span><span class="w"> </span><span class="n">submit_task_priority</span><span class="o">=</span><span class="n">CC</span><span class="p">.</span><span class="n">__PRIORITY__</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">CC</span><span class="w"></span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">EnvObj</span><span class="p">.</span><span class="nl">active</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="nf">log</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="ss">&quot;This channel is not active and it has been manually requested for use by the executor!&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">with</span><span class="w"> </span><span class="nl">CC</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">CC</span><span class="p">.</span><span class="n">executor</span><span class="p">(</span><span class="n">channelObject</span><span class="o">=</span><span class="n">EnvObj</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="getenvironment">getEnvironment</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">getEnvironment</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">autoCreate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">EnvironmentID</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">wait</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
    <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">EnvironmentControls</span><span class="p">]</span>
</code></pre></div>

<p>This grabs the next available EnvironmentControls object or creates one.</p>
<ul>
<li>:param autoCreate: (bool) default True, If no label or channelID is provided then this will make the method
    return a new _channelContainer if none available are found.</li>
<li>:param label: (str) default None. Looks for a particular label. Waits if it finds one but it is being used.
    Returns False is none are found.</li>
<li>:param channelID: (str) default None. Looks for a particular channelID. Waits if it finds it but finds it being
    used. Returns False</li>
<li>:param wait: (int) default 60. Tells how long to wait for a channel to become available.</li>
<li>:param delay: (float) default 0.1. Tells how long to pause between waiting.</li>
<li>:param kwargs: passed into a new _channelObject if this method tries to make a new channel.
-:return:</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">getEnvironment</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">autoCreate</span><span class="o">=</span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="n">EnvironmentID</span><span class="o">=</span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="n">wait</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="err">\</span><span class="w"></span>

<span class="w">            </span><span class="o">-&gt;</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">bool, EnvironmentControls</span><span class="o">]</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This grabs the next available EnvironmentControls object or creates one.</span>

<span class="ss">        - :param autoCreate: (bool) default True, If no label or channelID is provided then this will make the method</span>

<span class="ss">            return a new _channelContainer if none available are found.</span>

<span class="ss">        - :param label: (str) default None. Looks for a particular label. Waits if it finds one but it is being used.</span>

<span class="ss">            Returns False is none are found.</span>

<span class="ss">        - :param channelID: (str) default None. Looks for a particular channelID. Waits if it finds it but finds it being</span>

<span class="ss">            used. Returns False</span>

<span class="ss">        - :param wait: (int) default 60. Tells how long to wait for a channel to become available.</span>

<span class="ss">        - :param delay: (float) default 0.1. Tells how long to pause between waiting.</span>

<span class="ss">        - :param kwargs: passed into a new _channelObject if this method tries to make a new channel.</span>

<span class="ss">        -:return:</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">start_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">time</span><span class="p">.</span><span class="nc">time</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="nc">time</span><span class="p">.</span><span class="nc">time</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">start_time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nl">wait</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">channelObj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_checkEnvironments</span><span class="p">(</span><span class="n">autoCreate</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="p">,</span><span class="w"> </span><span class="n">EnvironmentID</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">channelObj</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">True</span><span class="err">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">channelObj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">createEnvironment</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">channelObj</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">False</span><span class="err">:</span><span class="w"></span>

<span class="w">                    </span><span class="nc">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="k">continue</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">channelObj</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">channelObj</span><span class="p">.</span><span class="n">active</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">channelObj</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="nf">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;ERROR in getEnvironment: There was a failure getting Channel: {e}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;[DEBUG] for getEnvironment: {traceback.format_exc()}&quot;</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="getmaxsessionsvalue">getMaxSessionsValue</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">getMaxSessionsValue</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">maxChannels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div>

<p>This attempts to change the max amount of channels this tool can use based on the target server's</p>
<p>MaxSessions variable in sshd_config file. If the machine received the argument maxChannels it will
    attempt to use that as long as it isn't above 10. The default value is 8.</p>
<ul>
<li>:param maxChannels:</li>
<li>:return:</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">getMaxSessionsValue</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">maxChannels</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">int</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">int</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This attempts to change the max amount of channels this tool can use based on the target server&#39;s</span>

<span class="ss">            MaxSessions variable in sshd_config file. If the machine received the argument maxChannels it will</span>

<span class="ss">            attempt to use that as long as it isn&#39;t above 10. The default value is 8.</span>

<span class="ss">        - :param maxChannels:</span>

<span class="ss">        - :return:</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">maxChannels</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">maxChannels</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">maxChannels</span><span class="w"></span>

<span class="w">            </span><span class="k">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">executeOnEnvironment</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">mainEnvironment</span><span class="p">,</span><span class="w"></span>

<span class="w">                                               </span><span class="n">self</span><span class="p">.</span><span class="n">_MaxSessionsString</span><span class="w"> </span><span class="o">%</span><span class="w"></span>

<span class="w">                                               </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_DEFAULT_MAX_SESSIONS</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_DEFAULT_MAX_SESSIONS</span><span class="p">),</span><span class="w"></span>

<span class="w">                                               </span><span class="n">self</span><span class="p">.</span><span class="n">mainEnvironment</span><span class="p">.</span><span class="n">prompt</span><span class="p">,</span><span class="w"></span>

<span class="w">                                               </span><span class="n">runTimeout</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">output</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_DEFAULT_MAX_SESSIONS</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nc">int</span><span class="p">(</span><span class="k">output</span><span class="p">.</span><span class="n">strip</span><span class="p">().</span><span class="n">splitlines</span><span class="p">()</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="p">.</span><span class="n">strip</span><span class="p">())</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="nf">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;error in getMaxSessionsValue: {e}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;[DEBUG] for getMaxSessionsValue: {traceback.format_exc()}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_DEFAULT_MAX_SESSIONS</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="getprompt">getPrompt</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">getPrompt</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">environment</span><span class="p">:</span> <span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">sshEnvironment</span><span class="p">,</span>
    <span class="n">reCapturePrompt</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span>
</code></pre></div>

<p>This captures the current prompt which is used to improve the performance of the buffer.</p>
<ul>
<li>:param environment: sshEnvironment object</li>
<li>:return: str or None</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">getPrompt</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">environment</span><span class="p">:</span><span class="w"> </span><span class="n">sshEnvironment</span><span class="p">,</span><span class="w"> </span><span class="nl">reCapturePrompt</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This captures the current prompt which is used to improve the performance of the buffer.</span>

<span class="ss">        - :param environment: sshEnvironment object</span>

<span class="ss">        - :return: str or None</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;ID: {environment._id} - Cached Prompt: {environment.prompt} - reCapturePrompt: {reCapturePrompt}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="n">prompt</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reCapturePrompt</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">False</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="n">prompt</span><span class="w"></span>

<span class="w">        </span><span class="n">environment</span><span class="p">.</span><span class="n">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_capturePrompt</span><span class="p">(</span><span class="n">environment</span><span class="p">,</span><span class="w"> </span><span class="n">StringIO</span><span class="p">())</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="n">prompt</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="isidle">isIdle</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">isIdle</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

<p>This checks the 'ThreadPool' class's 'isIdle()' function and returns the results.</p>
<ul>
<li>:return: bool</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">isIdle</span><span class="p">(</span><span class="kr">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">bool</span><span class="o">:</span><span class="w"></span>

<span class="w">        </span><span class="s">&quot;&quot;&quot; This checks the &#39;</span><span class="n">ThreadPool</span><span class="s">&#39; class&#39;</span><span class="n">s</span><span class="w"> </span><span class="s">&#39;isIdle()&#39;</span><span class="w"> </span><span class="kr">function</span><span class="w"> </span><span class="kr">and</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">results</span><span class="p">.</span><span class="w"></span>

<span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="o">:</span><span class="kr">return</span><span class="o">:</span><span class="w"> </span><span class="n">bool</span><span class="w"></span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        return self.tPool.is_idle</span>
</code></pre></div>

</details>
<h4 id="logoutconsole">logoutConsole</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">logoutConsole</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">logoutCmd</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">environment</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">sshEnvironment</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

<p>This reverses through past environment changes until it undoes the previous console escalation.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>logoutCmd</td>
<td>None</td>
<td>(str) (default None) This is a custom command to leave the console. For example 'exit' or</td>
<td></td>
</tr>
<tr>
<td>'quit'.</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>environment</td>
<td>None</td>
<td>(sshEnvironment/Paramiko Channel)</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td></td>
</tr>
</tbody>
</table>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">logoutConsole</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">logoutCmd</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nl">environment</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">sshEnvironment</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This reverses through past environment changes until it undoes the previous console escalation.</span>

<span class="ss">        :param logoutCmd: (str) (default None) This is a custom command to leave the console. For example &#39;exit&#39; or</span>

<span class="ss">            &#39;quit&#39;.</span>

<span class="ss">        :param environment: (sshEnvironment/Paramiko Channel)</span>

<span class="ss">        :return:</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">environment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">mainEnvironment</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">logoutCmd</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">logoutCmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;exit&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_bufferControl</span><span class="p">(</span><span class="n">environment</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;exit&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">StringIO</span><span class="p">(),</span><span class="w"> </span><span class="n">unsafe</span><span class="o">=</span><span class="k">True</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="n">pull</span><span class="p">()</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="nl">__CONSOLE_ESCALATION__</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">logoutConsole</span><span class="p">(</span><span class="n">logoutCmd</span><span class="p">,</span><span class="w"> </span><span class="n">environment</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">environment</span><span class="p">.</span><span class="n">getPrompt</span><span class="p">(</span><span class="n">reCapturePrompt</span><span class="o">=</span><span class="k">True</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="n">checkConnection</span><span class="p">()</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="logoutcurrentuser">logoutCurrentUser</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">logoutCurrentUser</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">environment</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">sshEnvironment</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">junkOut</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">_io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">reCapturePrompt</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">sshEnvironment</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span>
</code></pre></div>

<p>Runs the command 'exit' once on a specified environment. Effectively logging out of a user or other</p>
<p>escalation.</p>
<ul>
<li>:param environment: (sshEnvironment) default None -</li>
<li>:param junkOut: (StringIO) default None -</li>
<li>:param reCapturePrompt: (bool) default True -</li>
<li>:return: Either 'sshEnvironment' (success) or False (Failure)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">logoutCurrentUser</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">environment</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">sshEnvironment</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nl">junkOut</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">StringIO</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"></span>

<span class="w">                          </span><span class="nl">reCapturePrompt</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">sshEnvironment, bool</span><span class="o">]</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; Runs the command &#39;exit&#39; once on a specified environment. Effectively logging out of a user or other</span>

<span class="ss">            escalation.</span>

<span class="ss">        - :param environment: (sshEnvironment) default None -</span>

<span class="ss">        - :param junkOut: (StringIO) default None -</span>

<span class="ss">        - :param reCapturePrompt: (bool) default True -</span>

<span class="ss">        - :return: Either &#39;sshEnvironment&#39; (success) or False (Failure)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">environment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">mainEnvironment</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">checkConnection</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">environment</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="n">consoleStack</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">environment</span><span class="p">.</span><span class="n">consoleStack</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">environment</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">junkOut</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="nl">junkOut</span><span class="p">:</span><span class="w"> </span><span class="n">StringIO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StringIO</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_bufferControl</span><span class="p">(</span><span class="n">environment</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;exit&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">junkOut</span><span class="p">,</span><span class="w"> </span><span class="n">unsafe</span><span class="o">=</span><span class="k">True</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">environment</span><span class="p">.</span><span class="n">pull</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">checkConnection</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="nf">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Connection still valid on: {environment._id} - Num Escalations: {environment.numEscalations}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">getPrompt</span><span class="p">(</span><span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="p">,</span><span class="w"> </span><span class="n">reCapturePrompt</span><span class="o">=</span><span class="n">reCapturePrompt</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="nf">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Connection closed on: {environment._id}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">environment</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="removeenvironment">removeEnvironment</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">removeEnvironment</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">channel</span><span class="p">:</span> <span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">EnvironmentControls</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span>
</code></pre></div>

<p>Removed the provided object.</p>
<ul>
<li>:param channel: (_ChannelObject)</li>
<li>:return:</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">removeEnvironment</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">channel</span><span class="p">:</span><span class="w"> </span><span class="n">EnvironmentControls</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">bool</span><span class="o">]</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; Removed the provided object.</span>

<span class="ss">        - :param channel: (_ChannelObject)</span>

<span class="ss">        - :return:</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">_EnvironmentList</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">_EnvironmentList</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">            </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="ss">&quot;Channel %s appears to have already been removed!&quot;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">channel</span><span class="p">.</span><span class="n">EnvironmentID</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="nf">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="ss">&quot;ERROR: There was a failure in removeEnvironment: %s&quot;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="nf">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="ss">&quot;The failure is associated with channel: %s&quot;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">channel</span><span class="p">.</span><span class="n">EnvironmentID</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="resetenvironment">resetEnvironment</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">resetEnvironment</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">environment</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">sshEnvironment</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>As noted by the name this resets the values for the sshEnvironment class. <em>BE CAREFUL</em> this doesn't run</p>
<p>commands on the ssh channel environment meaning the actual environment on the target machine hasn't
    changed. This only clears the values recorded on the sshEnvironment class.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>environment</td>
<td>None</td>
<td>(sshEnvironment) default None - the sshEnvironment to run 'resetEnvironment' against.</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">resetEnvironment</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">environment</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">sshEnvironment</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; As noted by the name this resets the values for the sshEnvironment class. *BE CAREFUL* this doesn&#39;t run</span>

<span class="ss">            commands on the ssh channel environment meaning the actual environment on the target machine hasn&#39;t</span>

<span class="ss">            changed. This only clears the values recorded on the sshEnvironment class.</span>

<span class="ss">        :param environment: (sshEnvironment) default None - the sshEnvironment to run &#39;resetEnvironment&#39; against.</span>

<span class="ss">        :return: None</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">getattr</span><span class="p">(</span><span class="n">environment</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">mainEnvironment</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;resetEnvironment&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">dummy_func</span><span class="p">)()</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="threadeddisconnect">threadedDisconnect</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">threadedDisconnect</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">90</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>This does what it says. It disconnects the SSH connection to a server using a thread for each Environment.</p>
<p>This is not necessary faster. In fact it is often slower. This is designed if there are many connections
    open that have many user and environment escalations. In that situation this becomes faster then
    'disconnectEnvironments'. However, this is necessary to ensure that the logout commands are not given until
    all other threaded commands have finished.</p>
<div class="codehilite"><pre><span></span><code><span class="n">NOTE</span><span class="o">:</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="n">disconnect</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">later</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">established</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ThreadPool</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">work</span><span class="o">!</span><span class="w"></span>
<span class="w">    </span><span class="n">The</span><span class="w"> </span><span class="kd">function</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;setActiveThreads&#39;</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">again</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Threading</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">work</span><span class="o">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">var</span><span class="w"></span>
<span class="w">    </span><span class="s1">&#39;_MAX_CHANNELS&#39;</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="s1">&#39;setActiveThreads&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Parm</span><span class="w"> </span><span class="s1">&#39;maxThreads&#39;</span><span class="o">.</span><span class="w"></span>
</code></pre></div>

<ul>
<li>:param wait: (int) default 90 - How long the method is will too wait until all login commands are finished.</li>
<li>:return:</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">threadedDisconnect</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">wait</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">90</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This does what it says. It disconnects the SSH connection to a server using a thread for each Environment.</span>

<span class="ss">            This is not necessary faster. In fact it is often slower. This is designed if there are many connections</span>

<span class="ss">            open that have many user and environment escalations. In that situation this becomes faster then</span>

<span class="ss">            &#39;disconnectEnvironments&#39;. However, this is necessary to ensure that the logout commands are not given until</span>

<span class="ss">            all other threaded commands have finished.</span>

<span class="ss">            NOTE: If disconnect is called and then later another connection is established the ThreadPool will not work!</span>

<span class="ss">                The function: &#39;setActiveThreads&#39; will have to be called again in order for Threading to work. The var</span>

<span class="ss">                &#39;_MAX_CHANNELS&#39; must be passed to &#39;setActiveThreads&#39; as the Parm &#39;maxThreads&#39;.</span>

<span class="ss">        - :param wait: (int) default 90 - How long the method is will too wait until all login commands are finished.</span>

<span class="ss">        - :return:</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="nf">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39; === Disconnecting the SSH connection&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">current_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">time</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">_parseWait</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="nc">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">current_time</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">w</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">tPool</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">super</span><span class="p">(</span><span class="n">sshThreader</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">).</span><span class="n">disconnectEnvironments</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">with</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">tPool</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">self</span><span class="p">.</span><span class="n">tPool</span><span class="p">.</span><span class="n">wait_completion</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">wait</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="k">for</span><span class="w"> </span><span class="n">env</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">[</span><span class="n">envs for envs in self.EnvironmentList if not envs.isMain</span><span class="o">]</span><span class="err">:</span><span class="w"></span>

<span class="w">                        </span><span class="n">self</span><span class="p">.</span><span class="n">tPool</span><span class="p">.</span><span class="n">submit</span><span class="p">(</span><span class="n">env</span><span class="p">.</span><span class="n">disconnectEnvironment</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="n">self</span><span class="p">.</span><span class="n">tPool</span><span class="p">.</span><span class="k">join</span><span class="p">(</span><span class="n">_parseWait</span><span class="p">(</span><span class="n">wait</span><span class="p">))</span><span class="w"></span>

<span class="w">                </span><span class="n">super</span><span class="p">(</span><span class="n">sshThreader</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">).</span><span class="k">disconnect</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">mainEnvironment</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="nf">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Error in threadedDisconnect: {e}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;[DEBUG] for threadedDisconnect: {traceback.format_exc()}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="nl">finally</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">checkConnection</span><span class="p">()</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">super</span><span class="p">(</span><span class="n">sshThreader</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">).</span><span class="k">disconnect</span><span class="p">()</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="waitforidle">waitForIdle</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">waitForIdle</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

<p>This is a wrapper for the 'waitCompletion' method in ThreadingPool.</p>
<ul>
<li>:param kwargs: Review the 'waitCompletion' method in ThreadingPool for all the arguments.</li>
<li>:return: (bool)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">waitForIdle</span><span class="p">(</span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">bool</span><span class="o">:</span><span class="w"></span>

<span class="w">        </span><span class="s">&quot;&quot;&quot; This is a wrapper for the &#39;</span><span class="n">waitCompletion</span><span class="s">&#39; method in ThreadingPool.</span>

<span class="s">        - :param kwargs: Review the &#39;</span><span class="n">waitCompletion</span><span class="s">&#39; method in ThreadingPool for all the arguments.</span>

<span class="s">        - :return: (bool)</span>

<span class="s">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">tPool</span><span class="p">.</span><span class="n">wait_completion</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="whoami">whoami</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">whoami</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">environment</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">sshConnector</span><span class="o">.</span><span class="n">sshLibs</span><span class="o">.</span><span class="n">sshChannelEnvironment</span><span class="o">.</span><span class="n">sshEnvironment</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

<p>This returns the 'whoami' of the provided sshEnvironment. If an environment is not provided it pulls this</p>
<p>from the main Environment. Sense this is looking at a variable this is not always reliable because the
    variable may become de-synced with its actual environment. Also calling this from a thread may also result
    in the wrong information if the environment is also being acted upon. For accurate information use the
    'checkWhoAmI' method as this runs the 'whoami' command on sshEnvironment.</p>
<ul>
<li>:param environment: (sshEnvironment) default None -</li>
<li>:return (str)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">whoami</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">environment</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">sshEnvironment</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nf">str</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This returns the &#39;whoami&#39; of the provided sshEnvironment. If an environment is not provided it pulls this</span>

<span class="ss">            from the main Environment. Sense this is looking at a variable this is not always reliable because the</span>

<span class="ss">            variable may become de-synced with its actual environment. Also calling this from a thread may also result</span>

<span class="ss">            in the wrong information if the environment is also being acted upon. For accurate information use the</span>

<span class="ss">            &#39;checkWhoAmI&#39; method as this runs the &#39;whoami&#39; command on sshEnvironment.</span>

<span class="ss">        - :param environment: (sshEnvironment) default None -</span>

<span class="ss">        - :return (str)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">environment</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">mainEnvironment</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;whoami&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

</details>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../sshEnvironmentManager/" title="Sshenvironmentmanager" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Sshenvironmentmanager
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Powered by
        <a href="http://timothycrosley.github.io/portray">portray.</a>
        You too can
        <a href="http://timothycrosley.github.io/portray">
          portray</a>
        your Python project well using automatic documentation.
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.febc23d1.min.js"></script>
      
    
  </body>
</html>